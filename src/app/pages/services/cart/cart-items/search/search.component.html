<!-- search.component.html -->
<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
  <div class="bg-white rounded-lg w-full max-w-2xl p-6 max-h-[80vh] overflow-y-auto">
    <!-- Header -->
    <div class="flex justify-between items-center mb-4">
      <h2 class="text-xl font-semibold">Buscar Productos</h2>
      <button
        (click)="onClose()"
        class="text-gray-500 hover:text-gray-700">
        <i class="fas fa-times"></i>
      </button>
    </div>

    <!-- Search Bar -->
    <div class="mb-4">
      <div class="relative">
        <input
          type="text"
          [(ngModel)]="searchTerm"
          (input)="onSearch()"
          placeholder="Buscar por nombre o SKU..."
          class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
        >
        <button
          *ngIf="searchTerm"
          (click)="clearSearch()"
          class="absolute right-10 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600">
          <i class="fas fa-times-circle"></i>
        </button>
        <i class="fas fa-search absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
      </div>
    </div>

    <!-- Loading State -->
    <div *ngIf="isLoading" class="flex justify-center py-8">
      <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"></div>
    </div>

    <!-- Results -->
    <div class="space-y-4">
      <div *ngIf="!isLoading && searchResults.length === 0 && searchTerm"
           class="text-center py-4 text-gray-500">
        No se encontraron productos
      </div>

      <div *ngFor="let product of searchResults"
           class="flex items-center justify-between p-4 border rounded-lg hover:bg-gray-50">
        <!-- Product Image -->
        <div class="relative w-16 h-16 flex-shrink-0">
          <div *ngIf="product.imageLoading"
               class="absolute inset-0 flex items-center justify-center bg-gray-100 rounded-md">
            <div class="animate-spin rounded-full h-6 w-6 border-b-2 border-gray-900"></div>
          </div>
          <img [src]="product.imageUrl"
               [alt]="product.name"
               class="w-16 h-16 object-cover rounded-md"
               [class.opacity-0]="product.imageLoading"
               (load)="product.imageLoading = false"
               (error)="product.imageUrl = defaultImageUrl; product.imageLoading = false">
        </div>

        <!-- Product Details -->
        <div class="flex-grow ml-4">
          <h3 class="font-semibold text-gray-800">{{product.name}}</h3>
          <p class="text-sm text-gray-600">SKU: {{product.skuCode}}</p>
          <p class="text-green-600 font-medium">{{product.price | currency:'USD'}}</p>
        </div>

        <!-- Add Button -->
        <button
          (click)="onAddProduct(product)"
          class="ml-4 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors">
          Agregar
        </button>
      </div>
    </div>
  </div>
</div>
